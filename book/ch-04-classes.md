# 4 Դասեր

_Այդ տիպերը «վերացական» չեն. դրանք այնքան իրական են, որքան `int`-ը և `float`-ը:_

_— Դաֆ Մակլորի (Doug Mcllroy)_


* [Ներածություն](#4.1-Ներածություն)
* [Կոնկրետ տիպեր](#4.2-Կոնկրետ-տիպեր)
   * Թվաբանական տիպ
   * Կոնտեյներ
   * Կոնտեյներների սկզբնարժեքավորում
* Աբստրակտ տիպեր
* Վիրտուալ ֆունկցիաներ
* Դասերի հիերարխիա
   * Հիերարխաների առավելությունները
   * Hierarchy Navigation
   * Avoiding Resource Leaks
* Խորհուրդներ


## 4.1 Ներածություն

Այս և հաջորդ երեք գլուխների նպատակն է ձեզ գաղափար տալ C++-ում աբստրակցիայի և ռեսուրսների կառավարման մասին՝ առանց մանրամասների մեջ մտնելու։ ??

* Այս գլխում ոչ ֆորմալ կերպով ներկայացված են նոր տիպերի (_օգտագործողի սահմանած տիպ_) սահմանման և օգտագործման եղանակները։ Մասնավորապես, այստեղ ներկայացված են _կոնկրետ դասերի_, _աբստրակտ դասերի_ և _դասերի հիերարխիաների_ հիմնական հատկությունները, իրականացման հնարավորությունները և լեզվական միջոցները։
* [Գլուխ 5](ch-05-essential-operations.md)-ը ներկայացնում է այն գործողությունները, որոնք C++-ում ունեն որոշակի իմաստ. այդպիսիներից են կոնստրուկտորները, դեստրուկտորները և վերագրումը։ Այստեղ ուրվագծվում են այն կանոնները, որոնցով դրանք համատեղ օգտագործվում են օբյեկտների կյանքի փուլերը ղեկավարելու և պարզ, արդյունավետ ու լիարժեք ռեսուրսների կառավարում իրականացնելու համար։ ??
* [Գլուխ 6](ch-06-templates.md)-ում կաղապարները ներկայացվում են որպես տիպերն ու ալգորիթմները (այլ) տիպերով ու ալգորիթմներով պարամետրիզացնելու մեխանիզմ։ Օգտագործողի սահմանած և ներդրված տիպերով հաշվարկները ներկայացված են ֆունկցիաներով, երբեմն՝ ընդհանրացված որպես _ֆունկցիաների կաղապարներ_ և _ֆունկցիա օբյեկտներ_։ ??
* [Գլուխ 7](ch-07-concepts-and-generic-programming.md)-ը ներածություն է ընդհանրացված ծրագրավորման (generic programming) սկզբունքների, տեխնիկայի և լեզվական միջոցների։ ?? Շեշտադրումն արված է _կոնցեպտների_ սահմանման և օգտագործման վրա՝ կաղապարների ինտերֆեյսների ճշգրիտ սահմանման և նախագծման։ ??? _Վարիադիկ կաղապարները_ ներկայացված են որպես առավել ընդհանուր և ճկուն ինտերֆեյսների սահմանման միջոցներ։ ??

Սրանք այն լեզվական միջոցներն են, որոնք նախատեսված են _օբյեկտներին կողմնորոշված ծրագրավորում_ և _ընդհանրացված ծրագրավորում_ կոչվող ոճերն ապահովելու համար։ [8](ch-08-library-overview.md)-[15](ch-15-concurrency.md) գլուխներում ներկայացված են ստանդարտ գրադարանի հնարավորությունների և դրանց օգտագործման օրինակներ։

C++-ին հիմնական լեզվական միջոցը _դասն_ (class) է։ Դասը օգտագործողի սահմանած տիպ է, որը նախատեսված է ծրագրի կոդում ինչ-որ հասկացություն ներկայացնելու համար։ ?? Հենց որ մեր ծրագրի նախագծում ի հայտ է գալիս ինչ-որ օգտակար հասկացություն, գաղափար, էություն և այլն, մենք փորձում ենք այն ծրագրում ներկայացնել դասի տեսքով այնպես, որ այդ գաղափարը երևա կոդում, այլ ոչ թե պարզապես մեր գլխում, նախագծման փաստաթղթում կամ ինչ-որ մեկնաբանության մեջ։ ?? Դասերի ճիշտ ընտրված բազմությամբ կառուցված ծրագիրը շատ ավելի հեշտ է հասկանալ և պահել ճիշտ վիճակում,  քան այն, որտեղ ամեն ինչ ուղղակիորեն կառուցված է ներդրված տիպերի միջոցով։ ?? Մասնավորապես, գրադարանները սովորաբար բաղկացած են հենց դասերից։ ??

Ըստ էության, բոլոր լեզվական հնարավորությունները, ի թիվս հիմնարար տիպերի, գործողությունների (operator) և հրամանների (statement), գոյություն ունեն ավելի լավ դասեր սահմանելու կամ դրանք ավելի հարմար օգտագործելու համար։ «Ավելի լավ» ասելով ես նկատի ունեմ ավել ստույգ, հեշտ սպասարկվող, ավելի արդյունավետ, ավելի էլէգանտ, հեշտ օգտագործելի, հեշտ ընթեռնելի և easier to reason about։ ??? Ծրագրավորման հնարքների մեծամասնությունը ապավինում է որոշակի տեսակի դասերի նախագծմանն ու իրականացմանը։ Ծրագրավորողների կարիքներն ու ճաշակները չափազանց տարբեր են։ Հետևաբար դասերի աջակցումն էլ բազմազան է։ ?? Այստեղ կդիտարկենք միայն դասերի երեք կարևոր տիպերի հիմնական հատկությունները.

* Կոնկրետ դասեր (§4.2),
* Աբստրակտ դասեր (§4.3),
* Դասերը դասերի հիերարխիայի մեջ (§4.5)։

Պարզվում է, որ ապշեցուցիչ քանակի օգտակար դասեր են պատկանում այս երեք տեսակներից որևէ մեկին։ Էլ ավելի շատ դասեր կարող են դիտարկվել որպես այս երեք տեսակների ավելի պարզ տարբերակներ կամ որպես այս երեքում օգտագործված հնարքների համադրությամբ իրականացվածներ։ ???


## 4.2 Կոնկրետ տիպեր

_Կոնկրետ դասերի_ (concrette class) հիմնական գաղափարն այն է, որ նրանք իրենց պահում են «ճիշտ ինչպես ներդրված տիպերը»։ Օրինակ, կոմպլեքս թվերի տիպը և անվերջ ճշտությամբ ամբողջ թվերի տիպը շատ նման են ներդրված `int`-ին, բայց այն, իհարկե, որ դրան ունեն իրենց սեփական իմաստն (semantics) ու գործողությունների բազմությունը։ Նմանապես, `vector`-ը և `string`-ը շատ նման են ներդրված զանգվածներին, բացի այն, որ դրանք իրենց ավելի լավ են պահում (§9.2, §10.3, §11.2)։

Կոնկրետ տիպի որոշիչ բնութագիրն այն է, որ նրա ներկայացումը նրա սահմանման մասն է։ Շատ կարևոր դասերում, ինչպիսին է `vector`-ը, այդ ներկայացումը միայն մեկ կամ ավելի ցուցիչներ են, որոնք ցույց են տալիս ինչ-որ այլ տեղ պահված տվյալների, բայց այդ ներկայացում առկա է կոնկրետ դասի յուրաքանչյուր օբյեկտում։ ?? Դա հնարավորություն է տալիս իրականացումներին ժամանակի ու տարածության մեջ լինել առավել արդյունավետ։ Մասնավորապես, դա մեզ հնարավորություն է տալիս.

* կոնկրետ տիպերի օբյեկտները տեղավորել ստեկում, ստատիկ առանձնացված հիշողությունում այլ օբյեկտներում (§1.5),
* օբյեկտներին հղվել ուղղակիորեն (այլ ոչ միայն ցուցիչներով կամ հղումներով),
* անմիջապես ու լիարժեք սկզբնարժեքավորել օբյեկտները (այսինքն, կոնստրուկտորների օգտագործմամբ, §2.3), և
* պատճենել և փոխանակել օբյեկտները (§5.2)։

Ներկայացումը կարող է փակ (private) լինել (ինչպես `Vector`-ի համար է; §2.3) և հասանելի լինել միայն անդամ ֆունկցիաներով, բայց այն առկա է։ ?? Հետևաբար, եթե ներկայացումը ինչ-որ նշանակալի ձևով փոխվում է, օգտագործող կոդը պետք է նորից կոմպիլյացվի։ Սա այն գինն է, որ պետք է վճարել ներդրված տիպերին նման կոնկրետ տիպեր ունենալու համար։ Այն տիպերի համար, որոնք հաճախ չեն փոխվում, և որտեղ լոկալ փոփոխականները ապահովում են անհրաժեշտ հստակությունը, սա ընդունելի է և հաճած՝ իդեալական։ Ճկունություննը մեծացնելու համար կոնկրետ տիպը կարող է իր ներկայացման հիմնական մասը պահել ազատ հիշողության մեջ (դինամիկ հիշողություն, heap) և դրան հասանելություն ապահովել դասի օբյեկտի մեջ պահվող մասերից։ ?? Հենց այդպես են իրականացված `vector`-ն ու `string`-ը. դրանք կարող են դիտարկվել որպես ռեսուրսների handle` խնամքով մշակված ինտերֆեյսով։ ???
